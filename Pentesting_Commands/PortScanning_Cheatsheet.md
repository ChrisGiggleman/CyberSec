# 🛰️ Service & Port Scanning Cheatsheet

## 🔎 Nmap – Port & Service Scanning

### 🎯 Common Scans
| Command | Description |
|---|---|
| `nmap 192.168.1.10` | Basic scan of a single host |
| `nmap 192.168.1.0/24` | Scan an entire subnet |
| `nmap -p 22,80,443 192.168.1.10` | Scan specific ports |
| `nmap -p- 192.168.1.10` | Scan all 65,535 ports |
| `nmap -F 192.168.1.10` | Fast scan (top 100 ports) |

### 🔍 Service & Version Detection
| Command | Description |
|---|---|
| `nmap -sV 192.168.1.10` | Detect service versions |
| `nmap -sV --version-intensity 9 192.168.1.10` | Aggressive version detection |

### ⚡ Scan Types
| Command | Description |
|---|---|
| `nmap -sS 192.168.1.10` | Stealth SYN scan |
| `nmap -sT 192.168.1.10` | Full TCP connect scan |
| `nmap -sU 192.168.1.10` | UDP scan |
| `nmap -sA 192.168.1.10` | ACK scan (firewall mapping) |
| `nmap -sN 192.168.1.10` | Null scan (no flags set) |
| `nmap -sX 192.168.1.10` | Xmas scan (FIN, PSH, URG flags) |

### 🔧 Host Discovery
| Command | Description |
|---|---|
| `nmap -sn 192.168.1.0/24` | Ping sweep (host discovery only) |
| `nmap -Pn 192.168.1.10` | Treat host as alive (skip ping) |
| `nmap --traceroute 192.168.1.10` | Traceroute during scan |

### 📄 Output Options
| Command | Description |
|---|---|
| `nmap -oN scan.txt 192.168.1.10` | Save results to text |
| `nmap -oX scan.xml 192.168.1.10` | Save results to XML |
| `nmap -oG scan.gnmap 192.168.1.10` | Greppable output |
| `nmap -oA scan 192.168.1.10` | Save in all formats (`scan.nmap`, `.xml`, `.gnmap`) |

### 🔥 Aggressive & Script Scanning
| Command | Description |
|---|---|
| `nmap -A 192.168.1.10` | Aggressive scan (OS, version, scripts, traceroute) |
| `nmap --script=vuln 192.168.1.10` | Run vulnerability NSE scripts |
| `nmap --script http-enum 192.168.1.10` | Run specific NSE script |

---

## 🛠️ Custom Tool – `portscan`

### 🎯 Usage Examples
| Command | Description |
|---|---|
| `portscan 192.168.1.10` | Default scan on target host |
| `portscan 192.168.1.10 -p 22,80,443` | Scan specific ports |
| `portscan 192.168.1.10 -p-` | Full range scan |
| `portscan 192.168.1.10 --timeout 3` | Increase timeout for accuracy |
| `portscan 192.168.1.10 --banner` | Grab service banners |
| `portscan 192.168.1.10 --csv results.csv` | Export to CSV |
| `portscan 192.168.1.10 --log results.log` | Save results to log file |

### 📊 Output Format (example)
Port Status Service Banner
22 Open ssh OpenSSH 8.9p1
80 Open http Apache/2.4.52
443 Open https nginx/1.18.0
3306 Closed mysql -
